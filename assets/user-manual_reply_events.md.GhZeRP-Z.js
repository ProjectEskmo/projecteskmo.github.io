import{_ as t,c as e,o as d,a3 as r}from"./chunks/framework.x_GaNxP8.js";const p=JSON.parse('{"title":"回報事件","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"user-manual/reply/events.md","filePath":"user-manual/reply/events.md"}'),l={name:"user-manual/reply/events.md"},a=r(`<h1 id="回報事件" tabindex="-1">回報事件 <a class="header-anchor" href="#回報事件" aria-label="Permalink to &quot;回報事件&quot;">​</a></h1><h2 id="證券委託" tabindex="-1">證券委託 <a class="header-anchor" href="#證券委託" aria-label="Permalink to &quot;證券委託&quot;">​</a></h2><p>下表為證券委託回報事件：</p><table tabindex="0"><thead><tr><th>事件</th><th>註冊方式</th><th>回傳物件</th></tr></thead><tbody><tr><td>一般委託通知</td><td><a href="/user-manual/reply/latest/order.html">@api.event.order.notify</a></td><td><a href="#OrderNotifyResult">OrderNotifyResult</a></td></tr><tr><td>MIT 委託通知</td><td><a href="/user-manual/reply/latest/smart-order.html">@api.event.mit_order.notify</a></td><td><a href="#MITOrderNotifyResult">MITOrderNotifyResult</a></td></tr></tbody></table><h2 id="ordernotifyresult" tabindex="-1">OrderNotifyResult <a class="header-anchor" href="#ordernotifyresult" aria-label="Permalink to &quot;OrderNotifyResult&quot;">​</a></h2><p>委託通知事件，收到最新回報後委託收到更新，就會觸發獲得</p><table tabindex="0"><thead><tr><th style="text-align:center;">屬性</th><th style="text-align:center;">型別</th><th>說明</th><th>備註</th></tr></thead><tbody><tr><td style="text-align:center;">count</td><td style="text-align:center;"><code>int</code></td><td>委託流水號</td><td>Eskmo 自定義，可判斷委託先後</td></tr><tr><td style="text-align:center;">order</td><td style="text-align:center;"><a href="#orderstatus">OrderStatus</a></td><td>委託當前狀態</td><td></td></tr></tbody></table><p>count: int = 0 order: OrderStatus = None</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@api.event.order.notify</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onOrderNotify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data: OrderNotifyResult):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;委託通知: &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, data)</span></span></code></pre></div><h2 id="orderstatus" tabindex="-1">OrderStatus <a class="header-anchor" href="#orderstatus" aria-label="Permalink to &quot;OrderStatus&quot;">​</a></h2><p>委託當前狀態，在委託通知事件觸發後可得</p><table tabindex="0"><thead><tr><th style="text-align:center;">屬性</th><th style="text-align:center;">型別</th><th>說明</th><th>備註</th></tr></thead><tbody><tr><td style="text-align:center;">reply</td><td style="text-align:center;"><a href="#reply">Reply</a></td><td>最新回報</td><td></td></tr><tr><td style="text-align:center;">is_closed</td><td style="text-align:center;"><code>bool</code></td><td>是否結束</td><td></td></tr><tr><td style="text-align:center;">volume</td><td style="text-align:center;"><code>int</code></td><td>原始委託數</td><td></td></tr><tr><td style="text-align:center;">volume_remain</td><td style="text-align:center;"><code>int</code></td><td>剩餘委託數</td><td></td></tr><tr><td style="text-align:center;">volume_cancel</td><td style="text-align:center;"><code>int</code></td><td>刪除委託數</td><td></td></tr><tr><td style="text-align:center;">volume_deal</td><td style="text-align:center;"><code>int</code></td><td>成交委託數</td><td></td></tr></tbody></table><p>回傳結果中的委託數量以股數計</p><h2 id="reply" tabindex="-1">Reply <a class="header-anchor" href="#reply" aria-label="Permalink to &quot;Reply&quot;">​</a></h2><p>單筆委託可能有多次狀態更新，每次狀態變動都會對應到一個回報物件</p><table tabindex="0"><thead><tr><th style="text-align:center;">屬性</th><th style="text-align:center;">型別</th><th>說明</th><th>備註</th></tr></thead><tbody><tr><td style="text-align:center;">num</td><td style="text-align:center;"><code>int</code></td><td>Eskmo 自編序號</td><td>根據 API 取得順序遞增</td></tr><tr><td style="text-align:center;">key_no</td><td style="text-align:center;"><code>str</code></td><td>原始13碼委託序號</td><td></td></tr><tr><td style="text-align:center;">market</td><td style="text-align:center;"><code>str</code></td><td>市場別</td><td></td></tr><tr><td style="text-align:center;">type</td><td style="text-align:center;"><code>str</code></td><td>回報類型</td><td><code>N</code> 委託 <code>C</code> 取消 <code>U</code> 改量 <code>P</code> 改價 <code>D</code> 成交 <code>B</code> 改價改量 <code>S</code> 動態退單</td></tr><tr><td style="text-align:center;">status</td><td style="text-align:center;"><code>str</code></td><td>回報狀態</td><td><code>Y</code> 失敗 <code>T</code> 逾時 <code>N</code>正常</td></tr><tr><td style="text-align:center;">broker</td><td style="text-align:center;"><code>str</code></td><td>分公司代號</td><td></td></tr><tr><td style="text-align:center;">cust_no</td><td style="text-align:center;"><code>str</code></td><td>交易帳號</td><td></td></tr><tr><td style="text-align:center;">buysell_info</td><td style="text-align:center;"><code>str</code></td><td>證逐筆資訊</td><td>請見 SKCOM 文件</td></tr><tr><td style="text-align:center;">exchange_id</td><td style="text-align:center;"><code>str</code></td><td>交易所</td><td></td></tr><tr><td style="text-align:center;">symbol</td><td style="text-align:center;"><code>str</code></td><td>商品代碼</td><td></td></tr><tr><td style="text-align:center;">strike_price</td><td style="text-align:center;"><code>str</code></td><td>履約價</td><td></td></tr><tr><td style="text-align:center;">book_no</td><td style="text-align:center;"><code>str</code></td><td>委託書號</td><td></td></tr><tr><td style="text-align:center;">price</td><td style="text-align:center;"><code>str</code></td><td>價格</td><td>委託回報為委託價，成交回報為成交價</td></tr><tr><td style="text-align:center;">numerator</td><td style="text-align:center;"><code>str</code></td><td>分子</td><td>海外期貨回報用</td></tr><tr><td style="text-align:center;">denominator</td><td style="text-align:center;"><code>str</code></td><td>分母</td><td>海外期貨回報用</td></tr><tr><td style="text-align:center;">price_lags</td><td style="text-align:center;"><a href="#replyprice">list[ReplyPrice]</a></td><td>觸發價格</td><td></td></tr><tr><td style="text-align:center;">volume</td><td style="text-align:center;"><code>int</code></td><td>股數</td><td>委託回報為委託量，成交回報為成交量，改量回報為減量數，刪單回報為原委託剩量</td></tr><tr><td style="text-align:center;">before_qty</td><td style="text-align:center;"><code>int</code></td><td>異動變更前量</td><td>參考欄位，刪單為空值</td></tr><tr><td style="text-align:center;">after_qty</td><td style="text-align:center;"><code>int</code></td><td>異動變更後量</td><td>參考欄位，刪單為空值</td></tr><tr><td style="text-align:center;">date_str</td><td style="text-align:center;"><code>str</code></td><td>交易日期</td><td></td></tr><tr><td style="text-align:center;">time_str</td><td style="text-align:center;"><code>str</code></td><td>交易時間</td><td>含冒號，例如: <code>HH:MM:SS</code></td></tr><tr><td style="text-align:center;">ok_seq</td><td style="text-align:center;"><code>str</code></td><td>成交序號</td><td>請以 <code>execution_no</code> 為主</td></tr><tr><td style="text-align:center;">sub_id</td><td style="text-align:center;"><code>str</code></td><td>子帳帳號</td><td></td></tr><tr><td style="text-align:center;">sale_no</td><td style="text-align:center;"><code>str</code></td><td>營業員編號</td><td></td></tr><tr><td style="text-align:center;">agent</td><td style="text-align:center;"><code>str</code></td><td>委託介面</td><td></td></tr><tr><td style="text-align:center;">trade_date</td><td style="text-align:center;"><code>str</code></td><td>委託日期</td><td>僅提供海外委託，國內尚未提供</td></tr><tr><td style="text-align:center;">msg_no</td><td style="text-align:center;"><code>str</code></td><td>回報流水號</td><td></td></tr><tr><td style="text-align:center;">pre_order</td><td style="text-align:center;"><code>str</code></td><td>預約單別</td><td><code>A</code> 盤中單 <code>B</code> 預約單</td></tr><tr><td style="text-align:center;">commodity_lags</td><td style="text-align:center;"><a href="#replycommodity">list[ReplyCommodity]</a></td><td>商品回報資訊</td><td></td></tr><tr><td style="text-align:center;">execution_no</td><td style="text-align:center;"><code>str</code></td><td>成交序號</td><td></td></tr><tr><td style="text-align:center;">price_symbol</td><td style="text-align:center;"><code>str</code></td><td>下單期標</td><td></td></tr><tr><td style="text-align:center;">reserved</td><td style="text-align:center;"><code>str</code></td><td>T 盤別</td><td><code>A</code> T 盤 <code>B</code> T+1 盤<br>(僅國內期、選委託)</td></tr><tr><td style="text-align:center;">order_effective</td><td style="text-align:center;"><code>str</code></td><td>有效委託日</td><td></td></tr><tr><td style="text-align:center;">call_put</td><td style="text-align:center;"><code>str</code></td><td>選擇權類型</td><td><code>C</code> 買權 <code>P</code> 賣權</td></tr><tr><td style="text-align:center;">order_seq</td><td style="text-align:center;"><code>str</code></td><td>交易所單號</td><td>依海外交易所實際提供為主，又稱上手單號</td></tr><tr><td style="text-align:center;">error_msg</td><td style="text-align:center;"><code>str</code></td><td>委託單錯誤訊息</td><td>當 <code>status</code> 為 <code>Y</code> 時</td></tr><tr><td style="text-align:center;">cancel_order_mark_by_exchange</td><td style="text-align:center;"><code>str</code></td><td>交易所動態退單代碼</td><td>見下方 <a href="#動態退單說明">動態退單說明</a></td></tr><tr><td style="text-align:center;">exchange_tandem_msg</td><td style="text-align:center;"><code>str</code></td><td>交易所或後台退單訊息</td><td>見下方 <a href="#動態退單說明">動態退單說明</a></td></tr><tr><td style="text-align:center;">seq_no</td><td style="text-align:center;"><code>str</code></td><td>13碼序號</td><td></td></tr><tr><td style="text-align:center;">buysell</td><td style="text-align:center;"><code>str</code></td><td>證逐筆資訊-買賣別</td><td>見下方 <a href="#證逐筆資訊">證逐筆資訊說明</a></td></tr><tr><td style="text-align:center;">trade_type</td><td style="text-align:center;"><code>str</code></td><td>證逐筆資訊-交易別</td><td>見下方 <a href="#證逐筆資訊">證逐筆資訊說明</a></td></tr><tr><td style="text-align:center;">order_type</td><td style="text-align:center;"><code>str</code></td><td>證逐筆資訊-單別</td><td>見下方 <a href="#證逐筆資訊">證逐筆資訊說明</a></td></tr><tr><td style="text-align:center;">price_type</td><td style="text-align:center;"><code>str</code></td><td>證逐筆資訊-價別</td><td>見下方 <a href="#證逐筆資訊">證逐筆資訊說明</a></td></tr></tbody></table><h3 id="動態退單說明" tabindex="-1">動態退單說明 <a class="header-anchor" href="#動態退單說明" aria-label="Permalink to &quot;動態退單說明&quot;">​</a></h3><p>被「動態退單」的委託，會收到委託回報、取消回報與動態退單回報，若有成交部位還會有成交回報。</p><ul><li>買進委託：可能成交價格 &gt; 即時價格區間上限 → 退單</li><li>賣出委託：可能成交價格 &lt; 即時價格區間下限 → 退單</li></ul><p>即時價格區間上、下限計算公式</p><ul><li>即時價格區間上限 = 退單價＋退單點數</li><li>即時價格區間下限 = 退單價－退單點數</li><li>退單點數: 每日盤前計算完成(盤中固定)</li></ul><h3 id="證逐筆資訊說明" tabindex="-1">證逐筆資訊說明 <a class="header-anchor" href="#證逐筆資訊說明" aria-label="Permalink to &quot;證逐筆資訊說明&quot;">​</a></h3><p>證券回報會以五碼中英文字提供四項委託資訊，例如 <code>B04R2</code></p><p>可拆解成 <code>B</code> + <code>04</code> + <code>R</code> + <code>2</code>，對應則為 <code>買進</code>, <code>融券</code>, <code>ROD</code>, <code>限價</code></p><p>，Eskmo 對其轉換為四個欄位：</p><ul><li>買賣別 <code>buysell</code></li><li>交易別 <code>trade_type</code></li><li>單別 <code>order_type</code></li><li>價別 <code>price_type</code></li></ul><p>可以不管 <code>buysell_info</code> 字串，等價於上面四個欄位</p><h2 id="replyprice" tabindex="-1">ReplyPrice <a class="header-anchor" href="#replyprice" aria-label="Permalink to &quot;ReplyPrice&quot;">​</a></h2><p>回報價格分子分母物件</p><table tabindex="0"><thead><tr><th style="text-align:center;">屬性</th><th style="text-align:center;">型別</th><th>說明</th><th>備註</th></tr></thead><tbody><tr><td style="text-align:center;">price</td><td style="text-align:center;"><code>str</code></td><td>價格</td><td></td></tr><tr><td style="text-align:center;">numerator</td><td style="text-align:center;"><code>str</code></td><td>分子</td><td></td></tr><tr><td style="text-align:center;">denominator</td><td style="text-align:center;"><code>str</code></td><td>分母</td><td></td></tr></tbody></table><h2 id="replycommodity" tabindex="-1">ReplyCommodity <a class="header-anchor" href="#replycommodity" aria-label="Permalink to &quot;ReplyCommodity&quot;">​</a></h2><p>商品期貨選擇權的回報物件</p><table tabindex="0"><thead><tr><th style="text-align:center;">屬性</th><th style="text-align:center;">型別</th><th>說明</th><th>備註</th></tr></thead><tbody><tr><td style="text-align:center;">com_id</td><td style="text-align:center;"><code>str</code></td><td>商品 ID</td><td></td></tr><tr><td style="text-align:center;">year_month</td><td style="text-align:center;"><code>str</code></td><td>期貨結算年月</td><td></td></tr><tr><td style="text-align:center;">strike_price</td><td style="text-align:center;"><code>str</code></td><td>選擇權履約價</td><td></td></tr></tbody></table>`,33),n=[a];function c(o,s,i,y,h,g){return d(),e("div",null,n)}const u=t(l,[["render",c]]);export{p as __pageData,u as default};
