import{_ as s,c as a,o as i,a3 as t}from"./chunks/framework.x_GaNxP8.js";const u=JSON.parse('{"title":"錯誤處理","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"user-manual/system/error.md","filePath":"user-manual/system/error.md"}'),e={name:"user-manual/system/error.md"},n=t(`<h1 id="錯誤處理" tabindex="-1">錯誤處理 <a class="header-anchor" href="#錯誤處理" aria-label="Permalink to &quot;錯誤處理&quot;">​</a></h1><h2 id="註冊失敗事件" tabindex="-1">註冊失敗事件 <a class="header-anchor" href="#註冊失敗事件" aria-label="Permalink to &quot;註冊失敗事件&quot;">​</a></h2><p>在 Eskmo 中，大多數的正常與成功事件，也會伴隨失敗事件，例如：</p><table tabindex="0"><thead><tr><th>事件</th><th>說明</th></tr></thead><tbody><tr><td><a href="/user-manual/account/login.html">@api.event.quote.login_fail</a></td><td>登入失敗</td></tr><tr><td><a href="/user-manual/quote/live/quote.html">@api.event.quote.subscribe_fail</a></td><td>訂閱失敗</td></tr><tr><td><a href="/user-manual/quote/live/quote.html">@api.event.quote.unsubscribe_fail</a></td><td>解訂失敗</td></tr><tr><td><a href="/user-manual/order/stock/send.html">@api.event.order.send_fail</a></td><td>下單失敗</td></tr><tr><td><a href="/user-manual/order/stock/send.html">@api.event.order.placed_fail</a></td><td>掛單失敗</td></tr><tr><td><a href="/user-manual/order/stock/cancel.html">@api.event.order.cancel_fail</a></td><td>刪單失敗</td></tr><tr><td>...</td><td>...</td></tr></tbody></table><p>透過註冊這些失敗事件，當發生時在予以個別處理</p><p>對於初學者，建議顯示日誌 <code>api.logger.show = True</code> 以便發生失敗訊息沒有捕捉到而忽略</p><h2 id="api-執行錯誤" tabindex="-1">API 執行錯誤 <a class="header-anchor" href="#api-執行錯誤" aria-label="Permalink to &quot;API 執行錯誤&quot;">​</a></h2><p>當執行 API 函數遇到錯誤時，將會觸發 <code>@api.event.api.execute_error</code> 事件</p><p>透過註冊該事件，來捕捉 API 端錯誤的發生</p><h3 id="群益-skcom-api" tabindex="-1">群益 SKCOM API <a class="header-anchor" href="#群益-skcom-api" aria-label="Permalink to &quot;群益 SKCOM API&quot;">​</a></h3><p>舉例來說，在不輸入帳號密碼的情況下登入：</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> eskmo </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> api</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@api.event.api.execute_error</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> apiError</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;API 發生錯誤: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # API 發生錯誤: </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # APIExecuteErrorResult(event=&#39;SkcomExecFail&#39;, phase=&#39;AfterExec&#39;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # function=&#39;SKCenterLib_Login&#39;, error_code=602, errors=[&#39;未知 Error: 602&#39;])</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@api.start</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">():</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    api.login(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userId</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;A123456789&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">password</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;**********&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __name__</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;__main__&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    main()</span></span></code></pre></div><p>會觸發事件發生，通常會有 API 錯誤代碼 <code>error_code</code> ，就可以進一步到券商 API 文件中查詢</p><p>而錯誤代碼 <code>602</code> 就可以在 <code>策略王COM元件使用說明.docx</code> (<a href="https://www.capital.com.tw/CapitalGWAPI/srvcms/api/File/1861" target="_blank" rel="noreferrer">下載</a>) 發現是指帳號密碼錯誤</p><h2 id="注意事項" tabindex="-1">注意事項 <a class="header-anchor" href="#注意事項" aria-label="Permalink to &quot;注意事項&quot;">​</a></h2><p>券商 API 錯誤非 Eskmo 可控制與管理，建議對官方 API 更新保持關注</p>`,16),l=[n];function r(h,p,d,k,o,c){return i(),a("div",null,l)}const g=s(e,[["render",r]]);export{u as __pageData,g as default};
